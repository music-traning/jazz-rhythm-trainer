<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="本気でリズム感を鍛えたいミュージシャンのための、高精度リズムトレーニングアプリ。ジャズ特有のスイング、裏拍、ポリリズム、無音（Gap）トレーニングに対応。完全無料・インストール不要のブラウザアプリ（PWA）。">
    <meta name="keywords" content="リズムトレーニング, メトロノーム, ジャズ, 練習, アプリ, ポリリズム, 裏拍, スイング, PWA, 無料">
    <meta name="author" content="buro (Universal Make Associate)">
    <link rel="canonical" href="https://jazz-rhythm-trainer.vercel.app/"> 
    <meta property="og:type" content="website">
    <meta property="og:title" content="JAZZ RHYTHM TRAINER - God Tier Edition">
    <meta property="og:description" content="メトロノームを超えた「リズム矯正」ツール。そのリズムは、神の領域へ。">
    <meta property="og:site_name" content="JAZZ RHYTHM TRAINER">
    <meta property="og:image" content="https://jazz-rhythm-trainer.vercel.app/icon-512.png"> 
    <meta name="twitter:card" content="summary">
    <title>JAZZ RHYTHM TRAINER v5.4 (First Setup)</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="icon-192.png">
    <meta name="theme-color" content="#1a1a20">
    <link rel="apple-touch-icon" href="icon-192.png"> 

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <link rel="stylesheet" href="style.css">

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "JAZZ RHYTHM TRAINER",
      "url": "https://jazz-rhythm-trainer.vercel.app/",
      "description": "ジャズミュージシャンのための高機能リズムトレーニング・Webアプリ。スイング率の調整や無音区間設定が可能。",
      "applicationCategory": "MusicApplication",
      "operatingSystem": "Any",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "JPY"
      },
      "author": {
        "@type": "Person",
        "name": "buro"
      }
    }
    </script>
</head>
<body>

    <div id="title-screen">
        <div class="title-logo">JAZZ RHYTHM<br>TRAINER</div>
        <div class="title-sub">GOD TIER EDITION</div>
        
        <button class="lang-btn" onclick="setLang('ja')">🇯🇵 START (JP)</button>
        <button class="lang-btn" onclick="setLang('en')">🇺🇸 START (EN)</button>

        <div style="position:absolute; bottom:20px; font-size:0.7rem; color:#666; font-family:'Roboto Mono';">
            &copy; 2026 buro | <a href="https://note.com/jazzy_begin" target="_blank" style="color:#888;">note.com/jazzy_begin</a>
        </div>
    </div>

    <header class="hide-on-play" style="display:none;" id="main-header">
        <div class="brand">JRT <span style="font-size:0.6em; color:#666;">v5.4</span></div>
        <div>
            <button class="btn" id="btn-calib">🔧 CALIB</button>
            <button class="btn" id="btn-stats">📊 STATS</button>
            <button class="btn" id="btn-help">?</button>
        </div>
    </header>

    <div id="visualizer-area">
        <canvas id="gameCanvas"></canvas>
        <div id="countdown-overlay"><div id="countdown-text"></div></div>
        <div id="feedback-float"></div>
        <div id="hud">
            <div id="hud-status" style="font-family:'Roboto Mono'; color:var(--accent); font-size:0.8rem;">WAITING...</div>
            <div id="hud-time" style="font-size:1.5rem; font-weight:bold; font-family:'Roboto Mono';">00:00</div>
        </div>
    </div>

    <div id="app-footer" class="hide-on-play" style="display:none;">
        &copy; 2026 buro | <a href="https://note.com/jazzy_begin" target="_blank">note.com/jazzy_begin</a>
    </div>

    <div id="modal-welcome" class="modal-overlay">
        <div class="modal-box" style="text-align:center;">
            <h2 style="color:#fff; border:none;">INITIAL SETUP</h2>
            <div style="text-align:left; font-size:0.85rem; margin-bottom:20px; background:#222; padding:15px; border-radius:6px;">
                <div style="margin-bottom:10px;">
                    <strong style="color:var(--accent);">【必須】遅延調整</strong><br>
                    正確なリズム判定のため、最初に調整を行います。<br>下のボタンを押して開始してください。
                </div>
                <div style="border-top:1px solid #444; padding-top:10px; color:#aaa;">
                    <strong style="color:#fff;">[REQUIRED] Calibration</strong><br>
                    Let's calibrate your audio latency first.<br>Tap the button below to start.
                </div>
            </div>
            <button class="btn btn-main" onclick="startCalibrationFromWelcome()">🔧 START SETUP (設定開始)</button>
            <button class="btn" style="background:none; border:none; color:#555; font-size:0.8rem; margin-top:10px;" onclick="closeWelcome()">SKIP (スキップ)</button>
        </div>
    </div>

    <div id="modal-menu" class="modal-overlay">
        <div class="modal-box">
            <h2 id="menu-title">CURRICULUM</h2>
            <p id="menu-desc">...</p>
            <div id="lesson-list"></div>
            <button class="btn-reset" id="btn-reset-data">🗑 RESET DATA</button>
        </div>
    </div>

    <div id="modal-calibration" class="modal-overlay">
        <div class="modal-box" style="text-align:center;">
            <h2 style="text-align:center;">CALIBRATION</h2>
           <p style="text-align:center; font-size:0.85rem; color:#ccc; line-height:1.8;">
    リズムに合わせて<br>
    <span style="color:var(--accent);">タップ / クリック</span> または <span style="color:var(--accent);">キー(X/Z)</span><br>
    を叩いてください。
</p>
<p style="text-align:center; font-size:0.75rem; color:#777; margin-top:-10px; margin-bottom:20px;">
    Tap / Click screen OR Press keys<br>to the rhythm.
</p>
            <div id="calib-visual">TAP</div>
            <div style="margin:20px 0;">
                <div style="font-size:0.8rem; color:#888;">OFFSET (LATENCY)</div>
                <div class="calib-val"><span id="calib-offset-val">60</span><span style="font-size:1rem; color:#555;">ms</span></div>
            </div>
            <button class="btn btn-main" onclick="saveCalibration()">SAVE & CLOSE</button>
            <button class="btn btn-secondary" onclick="cancelCalibration()">CANCEL</button>
        </div>
    </div>

    <div id="modal-briefing" class="modal-overlay">
        <div class="modal-box">
            <h2 id="brief-title">LESSON X</h2>
            <div>
                <span class="briefing-tag">BPM: <span id="brief-bpm">0</span></span>
                <span class="briefing-tag">SWING: <span id="brief-swing">0%</span></span>
            </div>
            <div style="margin-top:15px; color:#aaa; font-size:0.8rem;">OBJECTIVE</div>
            <p id="brief-obj" style="font-weight:bold; color:#fff;">...</p>
            <div style="color:#aaa; font-size:0.8rem;">ADVICE</div>
            <div style="background:rgba(255,255,255,0.05); padding:10px; border-radius:4px; margin-bottom:15px; border-left:2px solid #fff;">
                <p id="brief-advice" style="margin:0; font-size:0.9rem;">...</p>
            </div>
            <button class="btn btn-demo" id="btn-play-demo">🔊 DEMO</button>
            <button class="btn btn-main" id="btn-start-session">START</button>
            <button class="btn" style="background:none; border:none; color:#666; width:100%; margin-top:5px;" id="btn-cancel-brief">CANCEL</button>
        </div>
    </div>

    <div id="modal-result" class="modal-overlay">
        <div class="modal-box" style="text-align:center;">
            <div style="font-size:0.8rem; color:#888; letter-spacing:2px;">RESULT</div>
            <div class="big-grade" id="res-grade">-</div>
            <div id="res-msg" style="font-weight:bold; margin-bottom:20px; color:#fff;">-</div>
            <div style="background:#222; padding:15px; border-radius:8px; text-align:left; margin-bottom:15px; font-family:'Roboto Mono';">
                <div style="display:flex; justify-content:space-between; border-bottom:1px solid #333; padding-bottom:5px;">
                    <span>TIMING</span><span id="res-bias">0ms</span>
                </div>
                <div style="display:flex; justify-content:space-between; padding-top:5px;">
                    <span>STABILITY</span><span id="res-sd">±0ms</span>
                </div>
            </div>
            <button class="btn btn-main" id="btn-next">NEXT</button>
        </div>
    </div>

    <div id="modal-stats" class="modal-overlay">
        <div class="modal-box">
            <h2 id="stats-title">STATS</h2>
            <div id="chart-container"><canvas id="statsChart"></canvas></div>
            <p style="font-size:0.75rem; color:#888;">(+) Late / (-) Fast</p>
            <button class="btn btn-main" id="close-stats">CLOSE</button>
        </div>
    </div>

    <div id="modal-help" class="modal-overlay">
        <div class="modal-box">
            <h2 id="help-title">HELP</h2>
            <div id="help-content"></div>
            <button class="btn btn-main" id="close-help">CLOSE</button>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>